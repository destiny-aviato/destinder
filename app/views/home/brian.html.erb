<% info = get_stats("too") %>
<% character_races = {0 => "Titan", 1 => "Hunter", 2 => "Warlock"} %>



<div class="container">
    <%= react_component 'Testing', { firstName: current_user.display_name } %>
    <div id="testing"></div>
    
    <h2 class="tooltip" title="This is my span's tooltip message!">Tooltip test</h2>
    <span class="tooltip" data-tooltip-content="#tooltip_content">This span has a tooltip with HTML when you hover over it!</span>
    
    <div class="tooltip_templates">
        <span id="tooltip_content">
            <table>
                <th>One</th>
                <th>Two</th>
                <th>Three</th>
                <tr>
                   <td>test</td>
                   <td>test</td>
                   <td>test</td>
                </tr>
            </table>
        </span>
    </div>
    
    <div class="row">
    <div class="col s12 m6 l4">
            <div id="136">
                <div class="card-panel grey lighten-5 z-depth-1 hoverable" style="max-height: 400px;">
                        <div class="post-header" style="background-image: url(https://www.bungie.net//common/destiny_content/icons/f341ac82eda0ff3ed941e4b83d01b5a0.jpg);">
                            <div class="row" style="overflow: hidden; max-height: 65px; ">
                                <div class="col s3 left-align" style="padding: 0; height: 65px;"><img style="max-width: calc(100% - 2.6em); min-width: 65px; position: relative; right: 3%; height: auto;" src="https://www.bungie.net//common/destiny_content/icons/473071c89230e751f8e1e6d4d6bc6129.jpg" alt="473071c89230e751f8e1e6d4d6bc6129"></div>
                                <div class="col s6 center-align" style="height: 65px; color: white;"><a style="font-size: 1.5em; text-overflow: ellipsis; color: #f5f5f5; position: relative; top: 25%; font-weight: 400;" href="/users/1">Luminusss</a></div>
                                <div class="col s3 center-align" style="height: 65px; color: white;">
                                    <span style="color: gold; position: relative; top: 10%; line-height: 2.5em; font-weight: 300; font-size: 0.9em;">✦ 397 </span>
                                    <span style="font-weight: 300; font-size: 0.9em;">Hunter</span>
                                </div>
                            </div>
                        </div>
                    <div class="card-content" style="padding-top: 25px;">
                        <br>
                         
                        <span>
                            <b>Trials of Osiris </b>
                            <br><small> about 6 hours ago</small>
                        </span>
                    
    
    
                    <br><br>    
                    <div class="row valign-wrapper">
                        <!-- <div class="col s2">
                            <img class="circle responsive-img" style="margin-left: -50%;" src="https://www.bungie.net//img/profile/avatars/bungie_day_15_27.jpg" alt="Bungie day 15 27" />
                        </div> -->
                        <div class="col s12">
                                <span class="black-text truncate" style="margin-left: -6%;">
                                    test
                                </span>
                        </div>
                    </div>
                        <div class="card-tabs">
                            <ul class="tabs post post-tabs" style="background-image: url(/assets/void-03712f4c0cbc4829d4d11297a2bcc76c6ac41129d36bf0dec5e7e75a026ebdf4.png);">
                                <li class="tab post"><a href="#136-yearly" class="tab-card-link active" style="color: #f5f5f5; font-size: 14px; text-shadow: none;">Year</a></li>
                                <li class="tab post disabled tooltipped" data-position="top" data-delay="50" data-tooltip="Coming soon!" data-tooltip-id="45fb42ed-2e63-e1a8-6660-bbeeee2f3d5e"><a href="#136-weekly" class="tab-card-link" style="color: #f5f5f5; font-size: 14px; text-shadow: none;">Week</a></li>
                                <li class="tab post disabled tooltipped" data-position="top" data-delay="50" data-tooltip="Coming soon!" data-tooltip-id="75fcd8ed-1322-fec4-4618-e557e96a7fa4"><a href="#136-map" class="tab-card-link" style="color: #f5f5f5; font-size: 14px; text-shadow: none;">Map</a></li>
                            <li class="indicator" style="right: 182px; left: 0px;"></li></ul>
                        </div>
                        <div class="card-content grey lighten-4">
                            <div id="136-yearly" class="active">
    
                                    <table class="table centered highlight">
                                        <thead>
                                            <tr>
                                                <th>K/D</th>
                                                <th>KA/D</th>
                                                <th>Win Rate</th>
                                                <th class="tooltipped" data-position="top" data-delay="50" data-tooltip="Based on guardian.gg's ELO ranking system" data-tooltip-id="725be509-3d13-692f-19ea-a03396164518">
                                                    ELO  <i class="fa fa-question-circle"></i>
                                                </th>
                                            </tr>
                                        </thead>
                                
                                        <tbody>
                                            <tr>
                                                <td>1.18</td>
                                                <td>1.64</td>
                                                <td>76%</td>
                                                <td>
                                                    1332
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                            </div>
    
                            <div id="136-weekly" style="display: none;">
                                    <table class="table centered highlight">
                                        <thead>
                                            <tr>
                                                <th>K/D</th>
                                                <th>KA/D</th>
                                                <th>Win Rate</th>
                                                <th class="tooltipped" data-position="top" data-delay="50" data-tooltip="Based on guardian.gg's ELO ranking system" data-tooltip-id="b0e28516-b71c-2d98-d089-06e5954bfb39">
                                                    ELO  <i class="fa fa-question-circle"></i>
                                                </th>
                                            </tr>
                                        </thead>
                                
                                        <tbody>
                                            <tr>
                                            <td>1.18 W</td>
                                            <td>1.64 W</td>
                                            <td>76% W</td>
                                            <td>1332 W</td>
                                            </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div id="136-map" style="display: none;">
                                    <table class="table centered highlight">
                                        <thead>
                                            <tr>
                                                <th>K/D</th>
                                                <th>KA/D</th>
                                                <th>Win Rate</th>
                                                <th class="tooltipped" data-position="top" data-delay="50" data-tooltip="Based on guardian.gg's ELO ranking system" data-tooltip-id="89629df8-8fd8-9213-6309-6b4c7e81c008">
                                                    ELO  <i class="fa fa-question-circle"></i>
                                                </th>
                                            </tr>
                                        </thead>
                                
                                        <tbody>
                                            <tr>
                                            <td>1.18 M</td>
                                            <td>1.64 M</td>
                                            <td>76% M</td>
                                            <td>1332 M</td>
                                            </tr>
                                        </tbody>
                                    </table>
                            </div>
                        </div>
                    <br> 
                    <!-- <div class="row" style="margin-bottom: 5px;">
                            <div class="chip tooltipped" style='color: #FAFAFA; background-color: #51de90; padding: 0 0px 0 8px;' data-position="top" data-delay="50" data-tooltip="Donated at least $5!">
                              <i class="material-icons" style="float: left; font-size: 14px; line-height: 23px; padding-right: 4px; margin-left: -6px;">attach_money</i>
                            </div>                
                            <div class="chip tooltipped" style='color: #FAFAFA; background-color: #026670; padding: 0 0px 0 8px;' data-position="top" data-delay="50" data-tooltip="One of the first 250 users on the site!">
                              <i class="fa fa-first-order" style="float: left; font-size: 14px; line-height: 23px; padding-right: 4px; margin-left: -6px;"></i>
                            </div>                
                    </div> -->
                    
                    <div class="row">
                            <div class="col s4 left-align">
                                <a target="_blank" href="/microposts">
                                <span class="icon">
                                    <i class="fa fa-envelope"></i>
                                </span>
    </a>                    </div>
                        <div class="col s4 center-align tooltipped" data-position="top" data-delay="50" data-tooltip="Player Reputation Score (1 votes)" data-tooltip-id="31e7c296-8312-be03-e3fa-942380540ee7">                            
                            100.0%
                        </div>
                        <div class="col s4 right-align">
                                <a data-confirm="Are you sure?" data-remote="true" rel="nofollow" data-method="delete" href="/microposts/136">
                                    <span class="icon">
                                    <i class="fa fa-trash"></i>
                                    </span>
    </a>                    </div>
                    </div>
                    
    
                    </div>
                    <div class="post-footer" style="background:black;">
                </div>
            </div>
        </div>
        </div>
    </div>
    </div>
    


    <div class="row">
        <div class="col s1"></div>
        <div class="col s6">
            <ul class="collapsible" data-collapsible="accordion" style="max-width: 170%; width: 337px;">
                <% info.each do |x| %>
                <% case x["Character Items"]["Subclass"]["Item Name"] 
                    when "Nightstalker", "Voidwalker", "Defender" %>
                        <% subclass =  "height: 20px; position: relative; bottom: 20px; background-image: url(#{image_path "void.png"}); background-size: cover;background-position-y: -50px;" %>
                        <% text_color =  "color: #f5f5f5; font-size: 14px; text-shadow: none;" %>
                    <% when "Sunsinger", "Gunslinger", "Sunbreaker" %>
                        <% subclass =  "height: 20px; position: relative; bottom: 20px;background-image: url(#{image_path "solar.png"}); background-size: cover;background-position-y: -50px;" %>
                        <% text_color =  "color: #3a3a3a; font-size: 14px;" %>
                    <% when "Bladedancer", "Striker", "Stormcaller" %>
                        <% subclass =  "height: 20px; position: relative; bottom: 20px; background-image: url(#{image_path "arc.png"}); background-size: cover;background-position-y: -50px;" %>
                        <% text_color =  "color: #3a3a3a; font-size: 14px;" %>
                <% end %>
                <li>
                    <div class="collapsible-header" style="height: 104px;">
                        <% bg = "background-image: url(#{x['Character Items']['Emblem Background']});" %>
                        <div class="post-header" style='<%= "#{bg} height: 100%; margin: -5.1%; height: 83px;" %>'>                            
                            <div class="row" style="overflow: hidden; max-height: 65px; ">
                                <div class="col s3 left-align" style="padding: 0; height: 65px;">
                                    <%= image_tag x["Character Items"]["Emblem"]["Item Icon"], style:"max-width: calc(100% - 2.6em); min-width: 65px; position: relative; right: 3%; height: auto;" %>
                                </div>
                                <div class="col s6 center-align" style="height: 65px; color: white;"><span style="font-size: 1.5em; text-overflow: ellipsis; color: #f5f5f5; position: relative; top: 25%; font-weight: 400;" ><%= current_user.display_name %></span></div>
                                <div class="col s3 center-align" style="height: 65px; color: white;">
                                    <span style="color: gold; position: relative; top: 10%; line-height: 2.5em; font-weight: 300; font-size: 0.9em;">✦ <%= x["Character Stats"]["Light Level"] %> </span>
                                    <span style="font-weight: 300; font-size: 0.9em;"><%= character_races[x["Character Type"]] %></span>
                                </div>
                            </div>
                            <div class="post-subheader" style="position: relative;height: 18px;bottom: 20px;">
                                <div class="container">
                                    <div class="row">
                                        <div class="col s4 left-align" style="white-space: nowrap;">
                                            <% if x["Character Stats"]["ELO"]["ELO"].to_i >= 1700 %>
                                                <% elo = "<span class='tooltip' data-tooltip-content='#diamond_elo_content' style='color:#7198B7;'> <b>#{x['Character Stats']['ELO']['ELO']}</b></span> " %>
                                            <% elsif x["Character Stats"]["ELO"]["ELO"].to_i < 1700 && x["Character Stats"]["ELO"]["ELO"].to_i >= 1500 %>
                                                <% elo = "<span class='tooltip' data-tooltip-content='#platinum_elo_content' style='color:#58907E;'> <b>#{x['Character Stats']['ELO']['ELO']}</b></span> " %>
                                            <% elsif x["Character Stats"]["ELO"]["ELO"].to_i < 1500 && x["Character Stats"]["ELO"]["ELO"].to_i >= 1300 %>
                                                <% elo = "<span class='tooltip' data-tooltip-content='#gold_elo_content' style='color:#CCAE50;'> <b>#{x['Character Stats']['ELO']['ELO']}</b></span> " %>
                                            <% elsif x["Character Stats"]["ELO"]["ELO"].to_i < 1300 && x["Character Stats"]["ELO"]["ELO"].to_i >= 1200 %>
                                                <% elo = "<span class='tooltip' data-tooltip-content='#silver_elo_content'  style='color:#BFC4C2;'> <b>#{x['Character Stats']['ELO']['ELO']}</b></span> " %>
                                            <% elsif x["Character Stats"]["ELO"]["ELO"].to_i < 1200 %>
                                                <% elo = "<span class='tooltip' data-tooltip-content='#bronze_elo_content' style='color:#AA885F;'> <b>#{x['Character Stats']['ELO']['ELO']}</b></span> " %>
                                            <% end %>                                                    
                                            <span class="white-text" style="font-size: 11px; vertical-align: text-top;">ELO: <%= elo.html_safe %></span>
                                        </div>
                                        <div class="col s4 center-align" style="white-space: nowrap;">
                                            <span class="white-text" style="font-size: 11px; vertical-align: text-top;">KD: <%= x["Character Stats"]["K/D Ratio"] %></span>
                                        </div>
                                        <div class="col s4 right-align" style="white-space: nowrap;">
                                            <span class="white-text" style="font-size: 11px; vertical-align: text-top;">W/L: <%= x["Character Stats"]["Win Rate"] %>%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="post-subclass-header" style='<%= subclass %>' ></div>
                        </div>
                    </div>

                    <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
                </li>
                <% end %>
            </ul>
        </div>
        <div class="col s5"></div>
    </div>

    <div class="row">
        <div class="col s12">
            <ul class="tabs">
                <li class="tab col s4"><a href="#char1">Character 1</a></li>
                <li class="tab col s4"><a href="#char2">Character 2</a></li>
                <li class="tab col s4"><a href="#char3">Character 3</a></li>                
            </ul>
        </div>



        <% info.each_with_index do |character, index| %>
            <div id='<%= "char#{index + 1}" %>' class="col s12">
                <div class='<%= "chart-container#{index + 1}" %>' data-chart-data="<%= character.to_json %>"></div>
                <div class="container">
                    <div class="row">
                        <div class="col s6">
                            <h4>Kill by Weapon Types</h4>
                            <div><canvas id='<%= "weapon-breakdown-chart#{index + 1}" %>' style="max-width: 500px !important; max-height: 500px !important"></canvas></div>        
                        </div>
                        <div class="col s6">
                            <h4>Player Ability Stats</h4>
                            <div><canvas id='<%= "ability-chart-breakdown#{index + 1}" %>'id="ability-chart-breakdown" style="max-width: 500px !important; max-height: 500px !important"></canvas></div>        
                        </div>
                    </div>
                </div>
            </div>
        <% end %>
    </div>




<code>
    <pre><%= JSON.pretty_generate(info) %></pre>    
</code>